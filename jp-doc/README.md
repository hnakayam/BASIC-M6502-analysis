# 6502マイクロプロセッサ用 Microsoft BASIC - バージョン 1.1

## 歴史的意義

このアセンブリ言語のソースコードは、初期のパーソナルコンピューター時代における最も歴史的に重要なソフトウェアの一つです。これは**Microsoft BASIC Ver. 1.1**の完全なソースコードであり、初期のパソコンの多くを支えた基盤となったものです。

### なぜこのドキュメントが歴史的に重要なのか

#### 1. パーソナルコンピューター革命の礎

- このBASICインタープリターは、初期の影響力あるパーソナルコンピューターの多くを支えたソフトウェア基盤でした
- シンプルで英語に近いプログラミング言語によって、非技術者にもプログラミングを身近なものにしました
- このソフトウェアがなければ、パーソナルコンピューター革命は全く異なる発展を遂げていたかもしれません

#### 2. マイクロソフト初期の成功

- これはマイクロソフトの最初期かつ最も成功したソフトウェアの一つです
- 複数のコンピューターメーカーへのBASICインタープリターのライセンス供与は、マイクロソフト初期のビジネスモデルにとって重要でした
- MS-DOSやWindowsより前に、パーソナルコンピューターソフトウェア分野でマイクロソフトの地位を確立しました

#### 3. マルチプラットフォーム対応

- この単一のコードベースは、当時の複数のコンピューターシステムで動作するよう設計されています
- 条件付きコンパイルシステムにより、同じソースコードが異なるハードウェア向けに対応可能です
- この手法は、その後数十年にわたりソフトウェア開発に影響を与えました

## 対応コンピューターシステム

ソースコードは、以下の先駆的なコンピューターシステム向けの条件付きコンパイルに対応しています：

- **Apple II** (`REALIO=4`) - スティーブ・ジョブズとスティーブ・ウォズニアックによる画期的な家庭用コンピューター
- **Commodore PET** (`REALIO=3`) - 最初期の完全なパーソナルコンピューターの一つ
- **Ohio Scientific (OSI)** (`REALIO=2`) - ホビイストや学校に人気
- **MOS Technology KIM-1** (`REALIO=1`) - 影響力のあるシングルボードコンピューター
- **PDP-10シミュレーション** (`REALIO=0`) - 開発・テスト用途

## 技術仕様

- **言語**：6502アセンブリ言語
- **対象プロセッサ**：MOS Technology 6502 8ビットマイクロプロセッサ
- **メモリ使用量**：8KB ROM版
- **機能**：浮動小数点演算を備えた完全なBASICインタープリター
- **アーキテクチャ**：ROM・RAM両方に対応した設計

## 主な特徴

### プログラミング言語サポート

- BASIC言語の完全実装
- 浮動小数点演算
- 文字列の取扱いと操作
- 配列（整数・文字列）のサポート
- 数学関数・演算子
- 入出力操作

### メモリ管理

- 8ビットシステム向けの効率的なメモリ利用
- 文字列ガベージコレクション
- 動的変数管理
- スタックベースの式評価

### ハードウェア抽象化

- 異なるコンピューター用のI/Oルーチン設定
- 端末幅の自動調整
- 文字入出力の抽象化
- オプションでディスクストレージ対応

## 開発履歴

ソースコードには、活発な開発の様子を示す詳細なリビジョン履歴が含まれています：

- **1978年7月27日**：FORループ変数処理と文解析の重大なバグ修正
- **1978年7月1日**：メモリ最適化とガベージコレクションの改良
- **1978年3月9日**：文字列関数の強化
- **1978年2月25日**：入力フラグ修正と数値精度向上
- **1978年2月11日**：予約語解析の改善
- **1978年1月24日**：ユーザー定義関数の改良

## 文化的な影響

### 教育分野への影響

- このBASICインタープリターは、何百万人もの人々にコンピュータープログラミングを紹介しました
- 後に業界のリーダーとなる多くの人々にとって、最初のプログラミング言語でした
- BASICのシンプルで対話的な性質は、非技術者にもコンピューターを身近なものにしました

### 業界標準化の推進

- マイクロソフトのBASICは、パーソナルコンピュータープログラミングの事実上の標準となりました
- ここで確立された設計パターンや慣習は、後のプログラミング言語や開発ツールに影響を与えました
- マルチプラットフォーム対応の手法は、現代のソフトウェア開発にも活用されています

### ビジネスモデルの革新

- 複数のハードウェアメーカーへのソフトウェアライセンス供与が、マイクロソフトの初期ビジネスモデルを築きました
- ソフトウェア単独のビジネスの実現可能性を示しました
- この手法は、ソフトウェア業界全体のテンプレートとなりました

## 技術的イノベーション

### コンパイラ技術

- 高度なマクロシステムによるコード生成
- マルチプラットフォーム対応の洗練された条件付きコンパイル
- 効率的なシンボルテーブル管理
- メモリ制約下での最適化されたコード生成

### ランタイムシステム

- スタックベースの式評価
- 動的メモリ管理
- リアルタイムガベージコレクション
- 対話型コマンド処理

## レガシー

このソースコードは、現代ソフトウェア産業の礎となったものです。本BASICインタープリターで先駆けられた技術、設計パターン、ビジネスモデルは、その後の以下の分野に大きな影響を与えました：

- MS-DOSやそれ以降のマイクロソフト製OSの開発
- プログラミング言語実装の標準化
- ソフトウェアライセンスによるビジネスモデルの確立
- コンピュータープログラミングの民主化

## ファイル情報

- **ファイル名**：`m6502.asm`
- **行数**：6,955行
- **著作権**：Microsoft Corporation, 1976-1978
- **バージョン**：1.1
- **アセンブル形式**：当時の6502開発用アセンブラに対応

---

*本ドキュメントは、パーソナルコンピューター革命を牽引し、マイクロソフトがソフトウェア業界のリーダーとなる礎を築いた、コンピューター史上極めて重要なソースコードです。*